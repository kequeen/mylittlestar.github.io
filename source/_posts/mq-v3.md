---
title: 小雨伞消息队列演化.md
date: 2019-02-24 22:40:42
tags:
---
### 前言
消息队列（Message queue，下面简称MQ）是一种进程间通信或同一进程的不同线程间的通信方式，常用于消息分发、系统解耦，流量削峰填谷等方面，是大型分布式系统不可或缺的中间件。
消息队列有两种模式，点对点和发布/订阅模式，点对点模式可以理解为发布/订阅模式的特例，其代表发布者与订阅者之间的关系为1:1,发布/订阅模型的话，发布者与订阅者的关系为1:N。小雨伞发展初期，只使用了点对点模式就满足了业务的需求，而随着业务的发展，原有的点对点模式越来越难以满足业务的需求，同时业务方也要求更高的可靠性，更及时的消息消费告警系统。

### 消息队列1.0
业务初期只采用了消息队列的点对点模式。原因如下：
- 公司发展初期，业务模型相对比较简单，点对点模式已经能够满足需求
- 系统本身使用redis作为缓存，基于redis进行消息队列的二次开发能够降低开发成本
- redis 实现的发布/订阅模型，其可靠性无法得到保证。具体原因如下：
redis的发布与订阅功能，其无法对消息进行持久化，意味着一旦订阅者发生异常，此时若有消息发送，那么系统会直接丢失此消息。作为金融公司，可靠性一定是要得到保证的。

因此，我们使用了redis的list实现了消息队列1.0系统。消息队列1.0


